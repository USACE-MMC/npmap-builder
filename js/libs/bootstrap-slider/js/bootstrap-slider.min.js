!function(b){var e=function(a,c){var d;"undefined"!==typeof Modernizr&&Modernizr.touch&&(this.touchCapable=!0);this.element=b(a);this.id=this.element.data("slider-id")||c.id;this.picker=b('<div class="slider"><div class="slider-track"><div class="slider-selection"></div><div class="slider-handle value"></div><div class="slider-handle min"></div><div class="slider-handle center"></div><div class="slider-handle max"></div></div><div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div></div>').insertBefore(this.element).append(this.element);this.id&&(this.picker[0].id=this.id);d=this.element.data("slider-tooltip")||c.tooltip;this.orientation=this.element.data("slider-orientation")||c.orientation;this.tooltip=this.picker.find(".tooltip");this.tooltipInner=this.tooltip.find("div.tooltip-inner");switch(this.orientation){case "vertical":this.mousePos="pageY";this.picker.addClass("slider-vertical");this.sizePos="offsetHeight";this.stylePos="top";this.tooltip.addClass("right")[0].style.left="100%";break;default:this.mousePos="pageX",this.orientation="horizontal",this.picker.addClass("slider-horizontal").css("width","100%"),this.sizePos="offsetWidth",this.stylePos="left",this.tooltip.addClass("top")[0].style.top=-this.tooltip.outerHeight()-38+"px"}this.center=this.element.data("slider-center")||c.center;this.max=this.element.data("slider-max")||c.max;this.min=this.element.data("slider-min")||c.min;this.step=this.element.data("slider-step")||c.step;this.value=this.element.data("slider-value")||c.value;this.value[1]&&(this.range=!0);this.selection=this.element.data("slider-selection")||c.selection;this.selectionEl=this.picker.find(".slider-selection");"none"===this.selection&&this.selectionEl.addClass("hide");this.selectionElStyle=this.selectionEl[0].style;this.handleCenter=this.picker.find(".slider-handle.center");this.handleCenterStype=this.handleCenter[0].style;this.handleMin=this.picker.find(".slider-handle.min");this.handleMinStype=this.handleMin[0].style;this.handleMax=this.picker.find(".slider-handle.max");this.handleMaxStype=this.handleMax[0].style;this.handleSingle=this.picker.find(".slider-handle.value");this.handleSingleMaxStype=this.handleSingle[0].style;this.range?(this.handleSingle.addClass("hide"),"undefined"===typeof this.center&&this.handleCenter.addClass("hide"),this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0])),this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))):(this.handleCenter.addClass("hide"),this.handleMin.addClass("hide"),this.handleMax.addClass("hide"),this.value=[Math.max(this.min,Math.min(this.max,this.value))],this.value[1]="after"===this.selection?this.max:this.min);this.diff=this.max-this.min;this.formatter=c.formatter;this.offset=this.picker.offset();this.percentage=[100*(this.value[0]-this.min)/this.diff,100*(this.value[1]-this.min)/this.diff,100*this.step/this.diff];this.size=b(this.picker[0]).width();this.layout();if(this.touchCapable)this.picker.on({touchstart:b.proxy(this.mousedown,this)});else this.picker.on({mousedown:b.proxy(this.mousedown,this)});if("show"===d)this.picker.on({mouseenter:b.proxy(this.showTooltip,this),mouseleave:b.proxy(this.hideTooltip,this)});else this.tooltip.addClass("hide")};e.prototype={constructor:e,inDrag:!1,over:!1,calculateValue:function(){var a;this.range?this.value=a=[this.min+Math.round(this.diff*this.percentage[0]/100/this.step)*this.step,this.min+Math.round(this.diff*this.percentage[1]/100/this.step)*this.step]:(a=this.min+Math.round(this.diff*this.percentage[0]/100/this.step)*this.step,this.value=[a,this.value[1]]);return a},getPercentage:function(a){this.touchCapable&&(a=a.touches[0]);return Math.max(0,Math.min(100,Math.round(100*(a[this.mousePos]-this.offset[this.stylePos])/this.size/this.percentage[2])*this.percentage[2]))},getValue:function(){return this.range?this.value:this.value[0]},hideTooltip:function(){!1===this.inDrag&&this.tooltip.removeClass("in");this.over=!1},layout:function(){this.handleMinStype[this.stylePos]=this.percentage[0]+"%";this.handleMaxStype[this.stylePos]=this.percentage[1]+"%";"vertical"===this.orientation?(this.selectionElStyle.top=Math.min(this.percentage[0],this.percentage[1])+"%",this.selectionElStyle.height=Math.abs(this.percentage[0]-this.percentage[1])+"%"):(this.selectionElStyle.left=Math.min(this.percentage[0],this.percentage[1])+"%",this.selectionElStyle.width=Math.abs(this.percentage[0]-this.percentage[1])+"%");this.range?(this.tooltipInner.text(this.formatter(this.value[0])+" - "+this.formatter(this.value[1])),this.tooltip[0].style[this.stylePos]=this.size*(this.percentage[0]+(this.percentage[1]-this.percentage[0])/2)/100-("vertical"===this.orientation?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px"):(this.tooltipInner.text(this.formatter(this.value[0])),this.tooltip[0].style[this.stylePos]=this.size*this.percentage[0]/100-("vertical"===this.orientation?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px")},mousedown:function(a){this.touchCapable&&"touchstart"===a.type&&(a=a.originalEvent);this.offset=this.picker.offset();this.size=this.picker[0][this.sizePos];a=this.getPercentage(a);if(this.range){var c=Math.abs(this.percentage[0]-a),d=Math.abs(this.percentage[1]-a);this.dragged=c<d?0:1}else this.dragged=0;this.percentage[this.dragged]=a;this.layout();if(this.touchCapable)b(document).on({touchmove:b.proxy(this.mousemove,this),touchend:b.proxy(this.mouseup,this)});else b(document).on({mousemove:b.proxy(this.mousemove,this),mouseup:b.proxy(this.mouseup,this)});this.inDrag=!0;a=this.calculateValue();this.element.trigger({type:"slideStart",value:a}).trigger({type:"slide",value:a});this.setValue(a);return!1},mousemove:function(a){this.touchCapable&&"touchmove"===a.type&&(a=a.originalEvent);a=this.getPercentage(a);this.range&&(0===this.dragged&&this.percentage[1]<a?(this.percentage[0]=this.percentage[1],this.dragged=1):1===this.dragged&&this.percentage[0]>a&&(this.percentage[1]=this.percentage[0],this.dragged=0));this.percentage[this.dragged]=a;this.layout();a=this.calculateValue();this.element.trigger({type:"slide",value:a}).data("value",a).prop("value",a);this.setValue(a);return!1},mouseup:function(){var a;this.touchCapable?b(document).off({touchmove:this.mousemove,touchend:this.mouseup}):b(document).off({mousemove:this.mousemove,mouseup:this.mouseup});this.inDrag=!1;!1===this.over&&this.hideTooltip();a=this.calculateValue();this.element.trigger({type:"slideStop",value:a}).data("value",a).prop("value",a);this.setValue(a);return!1},setValue:function(a){this.value=a;this.range?(this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0])),this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))):(this.handle2.addClass("hide"),this.value=[Math.max(this.min,Math.min(this.max,this.value))],this.value[1]="after"===this.selection?this.max:this.min);this.diff=this.max-this.min;this.percentage=[100*(this.value[0]-this.min)/this.diff,100*(this.value[1]-this.min)/this.diff,100*this.step/this.diff];this.layout()},showTooltip:function(){this.layout();this.over=!0;this.tooltip.addClass("in")}};b.fn.slider=function(a,c){return this.each(function(){var d=b(this),f=d.data("slider"),g="object"===typeof a&&a;f||d.data("slider",f=new e(this,b.extend({},b.fn.slider.defaults,g)));if("string"===typeof a)f[a](c)})};b.fn.slider.defaults={max:10,min:0,orientation:"horizontal",selection:"before",step:1,tooltip:"show",value:5,formatter:function(a){return a}};b.fn.slider.Constructor=e}(window.jQuery);